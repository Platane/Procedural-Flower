<html>
<head>
<style type="text/css">
.tableau {

border-radius:15px;
/*box-shadow:0 0 20px -0px #999 inset, 0 0 30px -0px #444;*/
height:1000px;
width:400px;
position:absolute;

transition-property:box-shadow;
-webkit-transition-property:box-shadow;
-moz-transition-property:box-shadow;
transition-duration:0.5s;
-webkit-transition-duration:0.5s;
-moz-transition-duration:0.5s;
background-color: white; 
border : solid 8px white;

display:inline-block;



}

body {
    background: rgb(215, 215, 215);
    background: -webkit-gradient(radial, 50% 50%, 0, 50% 50%, 500, from(rgb(240, 240, 240)), to(rgb(190, 190, 190)));
    background: -webkit-radial-gradient(rgb(240, 240, 240), rgb(190, 190, 190));
    background:    -moz-radial-gradient(rgb(240, 240, 240), rgb(190, 190, 190));
    background:     -ms-radial-gradient(rgb(240, 240, 240), rgb(190, 190, 190));
    background:      -o-radial-gradient(rgb(240, 240, 240), rgb(190, 190, 190));
    background:         radial-gradient(rgb(240, 240, 240), rgb(190, 190, 190));   

	background-repeat:no-repeat;
	background-attachment:fixed;	
}

.gravure {
-moz-user-select: none;
-webkit-user-select: none;
user-select: none;

font-family:calibri;

z-index: 10;
color: #333030;
font-style: italic;
position: absolute;
cursor:  default;
}

#option-text{
width:300px;
font-family:Consolas,Calibri;
font-size:10px;
display:inline-block;
}
</style>
<title>Procedural Flower</title>
<script type="text/javascript" src="../build/Flw.min.js"></script>
<script type="text/javascript" src="../libs/dat.gui.js"></script>
<script type="text/javascript">

window.onload = function(){
	
	var option = { widthStart : 3.1, widthEnd : 0.1, colorStart : "#000000", colorEnd : "#575050", maxDeepness : 3, maxDeepnessVar : 2, maxDeepnessTwisted : 5, maxDeepnessTwistedVar : 0, maxDeepnessMajor : 2, maxDeepnessMajorVar : 2, maxDeepnessMaster : 5, maxDeepnessMasterVar : 4, headSize : 37, headSizeVar : 37.5, leafSize : 30, leafSizeVar : 10, headColor : "#081107", headColorTintVar : 30, headColorValueVar : 0.168, headColorSatVar : 0.11, leafColor : "#20391f", leafColorTintVar : 24.200000000000003, leafColorValueVar : 0.2, leafColorSatVar : 0.2, radius : 55, radiusVar : 70, globalDirection : 1.5707963267948966, growVelocity : 0.1, strokeBranchWidth : 0, strokeBranchColor : '#000000', strokeLeafWidth : 0.8, strokeLeafColor : '#161616', strokeHeadWidth : 0.9, strokeHeadColor : '#1b1b1b', };
	var flw;
	var update=function(){
		var o=formateOption(option);
		var s=stringifyOption(o);
		var s_;
		while( (s_ = s.replace( "\n" , "<br>" ))!= s )
			s =s_;
		document.getElementById('option-text').innerHTML=s;
		for(var i in o)
			flw._root._option[i]=o[i];
		if( o.growVelocity && typeof(o.growVelocity) == "number" ){
			flw._growSpeed = option.growVelocity;
			flw._scrollCalculatorTimer = -100;
			flw._scrollCalculatorInterval = 200;
		}
	};
	var stringifyOption=function(o){
		var s="{\n";
		for( var i in o )
			if( o[i] instanceof Flw.Color )
				s+=i+" : Flw.createWithHex( '"+o[i].toString()+"' ),\n";
			else
			if( typeof(o[i])=="string" )
				s+=i+" : '"+o[i]+"',\n";
			else
				s+=i+" : "+o[i]+",\n";
		s=s+"}";
		return s;
	};
	var formateOption=function(o){
		var foption = {};
		for( var i in o )
			foption[i]=o[i];
		var color = [
			"colorStart",
			"colorEnd",
			"headColor",
			"leafColor",
		]
		var i=color.length;
		while(i--)
			foption[color[i]]=Flw.Color.createWithHex(o[color[i]]);
		return foption;
	};
	
	(function(scope){
		
		
		var gui = new dat.GUI();
		
		var head = gui.addFolder('Head');
	    head.add(option,'headSize').min(0).max(200).step(0.1).onChange(update);
		head.add(option,'headSizeVar').min(0).max(200).step(0.1).onChange(update);
		var headColor=head.addFolder('Color');
		headColor.addColor(option,'headColor').onChange(update);
		headColor.add(option,'headColorTintVar').min(0).max(360).step(0.1).onChange(update);
		headColor.add(option,'headColorValueVar').min(0).max(1).step(0.001).onChange(update);
		headColor.add(option,'headColorSatVar').min(0).max(1).step(0.001).onChange(update);
		var headStroke=head.addFolder('stroke');
		headStroke.add(option,'strokeHeadWidth').min(0).max(5).step(0.1).onChange(update);
		headStroke.addColor(option,'strokeHeadColor').onChange(update);
		
		var branch = gui.addFolder('Branch');
		branch.add(option,'radius').min(0).max(200).step(0.1).onChange(update);
		branch.add(option,'radiusVar').min(0).max(200).step(0.1).onChange(update);
		branch.add(option,'widthStart').min(0).max(10).step(0.1).onChange(update);
		branch.add(option,'widthEnd').min(0).max(10).step(0.1).onChange(update);
		branch.addColor(option,'colorStart').onChange(update);
		branch.addColor(option,'colorEnd').onChange(update);
		var branchStroke=branch.addFolder('stroke');
		branchStroke.add(option,'strokeBranchWidth').min(0).max(5).onChange(update);
		branchStroke.addColor(option,'strokeBranchColor').onChange(update);
		var branchSegments = branch.addFolder('segments');
	    branchSegments.add(option,'maxDeepness').min(0).max(20).step(1).onChange(update);
	    branchSegments.add(option,'maxDeepnessVar').min(0).max(20).step(0.1).onChange(update);
		branchSegments.add(option,'maxDeepnessMajor').min(0).max(20).step(1).onChange(update);
	    branchSegments.add(option,'maxDeepnessMajorVar').min(0).max(20).step(0.1).onChange(update);
		branchSegments.add(option,'maxDeepnessMaster').min(0).max(20).step(1).onChange(update);
	    branchSegments.add(option,'maxDeepnessMasterVar').min(0).max(20).step(0.1).onChange(update);
		branchSegments.add(option,'maxDeepnessTwisted').min(0).max(20).step(1).onChange(update);
	    branchSegments.add(option,'maxDeepnessTwistedVar').min(0).max(20).step(0.1).onChange(update);
		
		var leaf = gui.addFolder('Leaf');
	    leaf.add(option,'leafSize').min(0).max(100).step(0.1).onChange(update);
		leaf.add(option,'leafSizeVar').min(0).max(100).step(0.1).onChange(update);
		var leafColor=leaf.addFolder('Color');
		leafColor.addColor(option,'leafColor').onChange(update);
		leafColor.add(option,'leafColorTintVar').min(0).max(360).step(0.1).onChange(update);
		leafColor.add(option,'leafColorValueVar').min(0).max(1).step(0.001).onChange(update);
		leafColor.add(option,'leafColorSatVar').min(0).max(1).step(0.001).onChange(update);
		var leafStroke=leaf.addFolder('stroke');
		leafStroke.add(option,'strokeLeafWidth').min(0).max(5).step(0.1).onChange(update);
		leafStroke.addColor(option,'strokeLeafColor').onChange(update);
		
		gui.add(option,'growVelocity').min(0).max(1).step(0.001).onChange(update);
		
	})(this);
	
	var e = document.getElementById('container');
	flw = Flw.RampantFlower.create( e , formateOption(option) , true );
	update();
	
	// drag and drop
		(function(){
			var e = document.getElementById('container');
			var anchorM = { x : 0 , y : 0 };
			var anchorE = { x : 0 , y : 0 };
			var savedBoxShadow;
			var drag = false;
			e.onmousedown = function(ev){
				if( drag )
					return;
				anchorM.x = ev.pageX;
				anchorM.y = ev.pageY;
				anchorE.x = parseInt( (/^[-0-9]*/).exec(  e.style.left )[0] );
				anchorE.y = parseInt( (/^[-0-9]*/).exec(  e.style.top  )[0] );
				drag = true;
			}
			
			document.body.onmousemove = function(ev){
				if( !drag )
					return;
				e.style.left = Math.round( anchorE.x + ev.pageX - anchorM.x )+"px";
				e.style.top  = Math.round( anchorE.y + ev.pageY - anchorM.y )+"px";
				
			}
			e.onmouseup = function(ev){
				drag = false;
			}
		})();
}
</script>
</head>
<body >

<div id="option-text" ></div>

<div id="container" class="tableau" style="height:600px;width:400px;position:absolute;top:30px;left:300px;" > <div class="gravure" style="bottom:1px;right:20px;">Platane</div> </div>



</body>
</html>